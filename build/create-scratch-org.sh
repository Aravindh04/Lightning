# Get the private key from the environment variable
echo "Setting up DevHub Connection..."
mkdir keys
echo $SFDC_SERVER_KEY | base64 -d > keys/server.key

# Authenticate to salesforce
echo "Authenticating..."
sfdx force:auth:jwt:grant --clientid $SFDC_PROD_CLIENTID --jwtkeyfile keys/server.key --username $SFDC_PROD_USER --setdefaultdevhubusername -a DevHub

#Create a scratch org
echo "Creating the Scratch Org..."
sfdx force:org:create -f config/project-scratch-def.json -a ${CIRCLE_BRANCH} -s

bGWZtlxYEgFYecybJMU3asaJXckv71CjYCVxG2V/3XhG5tzVxkT+bX7WQNy342w/
3ww62uy4K1+S/8vwywwZbmfi/9FjKfNUo0SvQAEHQV1cz6IVU/KtwIZdlZQcQIdC
ihXky6MaaDZ/+DWHEwRsnGE55H3BOW1agYAIfetr5GEG1T30Vnydo0o1hL8MVitx
xcYoqdz3ludaNVmBqCUTiWOBhQRIN3YmHgQtTqJ8/yuClnm9+5l+n5tFPRsw4f0K
vgor3/1rK1b722p2wSw6j3Oc6B972uWQ3/6f/FipZZsC5JiQ1Ixhler9BWwITYRC
XhcfQAkddcIPYJYbhLBu8f9bs2y1JXdPY/K/SglQuFKd2t8fEo5n/l0HO9xDZ/ou
8ulFKe7mvr/glBO29rThyqw3FF5VtSFNrBRuUZ1v4KvOljqh6FqKB5v/nbe7A3pv
+Hjy3IUujWNEIBtgUadzvPsriTr0SafS3Ll4WM7urtJp13Zw60oeQb/9yqpV/r6K
+ZJM9HouSYN47MQHhtSbhfdsXVD3J9TozWAVtlNi+D3WrREr7BZZ/oterIF2VWJ7
XeWQDvmY2fRTPPf1MRa50gh7Rx5qHEf3+xvv7TeQh3YBXN6qMYceL8Xs+GIePcqD
PqXjlC6aENdAaCyTEkT9wx/2X+AGvZ4rSsIVycwYtO9WUU1fHW74ZRSDiH6o2tlR
DU5ZRcXtFHYflHX3zXZ/DOglDCWlwyRhGfzIQc8PKPHa/Aap0rQIfoebV73JIC/Y
NkcByJJyzcKK/0gLffB08CGm+R6vxon8ep4/dIDQReRV0EGVaQn5CvBHoHc1Eai4
/uwHzLgCOI9lK0EWolhl3yatkchFXZKwBQGlnxxOSzjyHoU+9bWmcFMdstRGrh9Y
s+8Ot+UyhD9f0oT2Q3ZdS9617obvX1ZtAtLSOydzu0ZeaTF3U3V5LKxvcbV28Hmp
8o9m8tdwI95m9/ehEIvnp9NfAIU6r8DvjCgzu4ZEF+nOzDaO9ZUdbfeWgfR7Qv8t
pBQ58NWQ16kqCIG2TQktfI1YwNO0w9KbavARn5z/J2lKh6P4qzTiLKe3GLd4zOcw
R6I35Ev5+0DmeTkyQuXUtSuwXVD4RrAgTLqmCzhOf6Z/9lOV9faT9hfR0/c/UTy+
l2TXuYrh6VCnOFU25NyLcK8wZ9eJeCaS2239anTEjPXqAuhLD6Zi07725VQbB21A
EVsJBoO3/ifuIhFFIkR6CZCQaSEuuu6Elxzw6B6eWd8tydEp41mzMdB16GjIUz2t
XqpujMhv11CfXofhDOW18B7apfCALGffzfGNCiSr8pH7g6vL4ko0Z58LPZ+bPVSq
+8FAKEcSoTF3hUz56uDbU2xEe/3hs+5XmsM/5a37HFymmksROEe5IKb2HAIyXc7I
sAsYAtBFWdyrcNk5j4JoJBny0JvX4KqY2QBb4E20eWIlDrO4x7OkyMn92fcYh7O2
CRNUzSaLmIXWsfLiarej5GsqY/QI89YGmqDotpr4n2/rX0FclCmaIeM8suWCKyaj
VdzLLJZ3rcFN0gYX1ZJ72PVZZIBZRBV761a1Zt2sNih+oiVnqwNiv5/I/4OMnTPo